# Audio Watermarking Project

This project implements a robust audio watermarking system using Discrete Wavelet Transform (DWT), Discrete Tchebichef Moment Transform (DTMT), and Modified Localized Nonlinear Chaotic Map Lattice (MLNCML) for embedding and extracting watermarks in audio files.

## Features

- **Watermark Embedding**: Embed binary image watermarks into audio signals using DWT, DTMT, and chaotic encryption.
- **Watermark Extraction**: Extract watermarks from potentially attacked audio signals.
- **Robustness Testing**: Test watermark robustness against various attacks like filtering, noise, cropping, MP3 compression, re-recording, and time scaling.
- **Modular Design**: Clean separation of concerns with dedicated modules for each transform and utility functions.

## Project Structure

```
dsp-project/
│
├── README.md
├── requirements.txt
├── documentation/
│   └── dsp_project_doc.tex
├── results/
│   ├── embed_results/
│   │   ├── embed_params.json
│   │   └── watermarked.wav (generated)
│   └── extract_results/
│       └── extracted_watermark.png (generated)
│   └── attack_results/ (generated by tests)
├── src/
│   ├── main.py              # Main entry point for embedding and extraction
│   ├── embed.py             # Watermark embedding logic
│   ├── extractor.py         # Watermark extraction logic
│   ├── dwt.py               # Discrete Wavelet Transform implementation
│   ├── dtmt.py              # Discrete Tchebichef Moment Transform implementation
│   ├── mlncml.py            # Chaotic map for watermark encryption
│   ├── utils.py             # Utility functions for audio/image I/O
│   ├── test_main.py         # Robustness testing against various attacks
│   └── __pycache__/
└── tests/
    ├── test_dtmt.py
    ├── test_dwt.py
    ├── test_extractor.py
    ├── test_mlncml.py
    └── __pycache__/
```

## Installation

1. Clone the repository:
   ```bash
   git clone https://github.com/Meghadri25/dsp-project.git
   cd dsp-project
   ```

2. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

## Usage

### Embedding Watermark

To embed a watermark into an audio file:

```bash
python src/main.py --mode=embed
```

This will:
- Load `The_Color_Violet.wav` as input audio
- Load `watermark.png` as the watermark image
- Embed the watermark using the specified parameters
- Save the watermarked audio to `results/embed_results/watermarked.wav`
- Save embedding parameters to `results/embed_results/embed_params.json`

### Extracting Watermark

To extract the watermark from watermarked audio:

```bash
python src/main.py --mode=extract
```

This will:
- Load the watermarked audio from `results/embed_results/watermarked.wav`
- Extract the watermark using the saved parameters
- Save the extracted watermark image to `results/extract_results/extracted_watermark.png`

### Running Robustness Tests

To test watermark robustness against various attacks:

```bash
python src/test_main.py
```

This will apply attacks like low-pass/high-pass filtering, cropping, noise addition, MP3 compression, re-recording simulation, and time scaling, then extract watermarks and compute metrics (BER, NC, SNR, SI-SDR, SSIM, LMSE).

Results are saved to `results/attack_results/` with individual subdirectories for each attack containing the attacked audio and extracted watermark image. A summary CSV is generated at `results/attack_results/results_summary.csv`.

## Key Components

### DWT (dwt.py)
Implements 3-level Haar wavelet transform for audio decomposition.

### DTMT (dtmt.py)
Implements Discrete Tchebichef Moment Transform for feature extraction from wavelet coefficients.

### MLNCML (mlncml.py)
Generates chaotic matrices for watermark encryption using modified logistic map and Arnold cat map.

### Embedding (embed.py)
Segments audio, applies DWT, embeds watermark bits by modifying DTMT moments, and reconstructs watermarked audio.

### Extraction (extractor.py)
Extracts watermark bits from audio by analyzing DTMT moments and decrypts using the chaotic matrix.

### Utils (utils.py)
Provides functions for loading/saving audio and images, and parameter management.

## Configuration

- **Audio Input**: Place your input audio file as `The_Color_Violet.wav` in the root directory
- **Watermark Input**: Place your binary watermark image as `watermark.png` in the root directory
- **Parameters**: Modify embedding parameters in `main.py` (epsilon, eta, mu, etc.)

## Dependencies

- numpy
- soundfile
- imageio
- scipy
- pydub
- librosa
- scikit-image

## Notes

- The system is designed for WAV audio files
- Watermark images are automatically resized and binarized
- For MP3 compression testing, FFmpeg is required (pydub dependency)
- Test results are cached; re-running skips already processed attacks

## License

This project is for educational and research purposes.
